<html>

<body>
    <div>
        <p>client_id: bb68d439-17c7-4f6b-8f4d-e5acfa26f284</p>
        <p>client_secret: sGf7n2gU5X-Y@4spB.hUVBm]uGgEc2zA</p>
    </div>
    <div>
        <div>
            <a
                href='https://login.microsoftonline.com/common/oauth2/v2.0/authorize?scope=https%3A%2F%2Fgraph.microsoft.com%2FFiles.ReadWrite.All+offline_access&response_type=code&client_id=bb68d439-17c7-4f6b-8f4d-e5acfa26f284&redirect_uri=https://sevenyes.github.io/onepoint/'>click

                here to get your refresh code</a>
        </div>
        <div id='info'></div>
        <form action="https://login.microsoftonline.com/common/oauth2/v2.0/token" method="POST" style="display:none;">
            <input type="text" name="client_id" placeholder="client_id" value="bb68d439-17c7-4f6b-8f4d-e5acfa26f284" />
            <input type="text" name="client_secret" placeholder="client_secret"
                value="sGf7n2gU5X-Y@4spB.hUVBm]uGgEc2zA" />
            <input type="text" name="grant_type" placeholder="authorization_code" value="authorization_code" />
            <input type="text" name="requested_token_use" placeholder="on_behalf_of" value="on_behalf_of" />
            <input type="text" name="redirect_uri" placeholder="redirect_uri"
                value="https://sevenyes.github.io/onepoint/" />
            <input type="text" name="code" placeholder="code" id="code" />
            <input type="submit" id='submit' />
        </form>
        <script>

            let url = new URL(window.location.href);
            if (url.searchParams.get('code')) {
                document.getElementById('code').value = url.searchParams.get('code');
                document.getElementById('submit').click();
            } else if (url.searchParams.get('error')) {
                document.getElementById('info').innerText = url.searchParams.get('error') + ":\n" + url.searchParams
                    .get('error_description');
            }
        </script>
</body>

</html>
